# Project ManaTI. Machine Learning for Threat Intuitive Analysis
The goal of the ManaTi project is to develop machine learning techniques to assist an intuitive threat analyst to speed the discovery of new security problems. The machine learning will contribute to the analysis by finding new relationships and inferences. The project will include the development of a web interface for the analyst to interact with the data and the machine learning output.

## Versions
- Fri Mar 31 12:19:00 CEST 2017: Version 0.7.1
- Sun Mar  5 00:04:41 CEST 2017: Version 0.7
- Thu Nov 10 12:30:45 CEST 2016: Version 0.6.2.1
- Wed Oct 12 21:19:21 CEST 2016: Version 0.5.1
- Wed Sep 21 17:56:40 CEST 2016: Version 0.41
- Tue Sep 13 10:52:36 CEST 2016: Version 0.4
- Thu Aug 18 15:44:31 CEST 2016: Version 0.3
- Wed Jun 29 10:44:15 CEST 2016: Version 0.2

## Authors

- Raul B. Netto (raulbeni@gmail.com )
- Sebastian Garcia (sebastian.garcia@agents.fel.cvut.cz, eldraco@gmail.com)

## Settings: for Installation Zero for deployments
ManaTI is a django project with a postgres database and it works in Linux and MacOS. We recommend using a virtualenv environment to setup it. The installation steps for linux are:

1. git clone git@bitbucket.org:rbenitez/project_manati.git
2. apt-get install virtualenv
3. virtualenv vmanati
4. source vmanati/bin/activate
5. sudo apt-get install postgresql-server-dev-all
6. pip install -r requirements.txt
7. Start postgresql

    /etc/init.d/postgresql start

## Configure the database
8. As root: (There should be a user postgres after installing the database)

    su - postgres 
9. Create the database: 

    psql

    create user manati_db_user with password 'password';

    create database manati_db_instance_a;

    grant all privileges on database manati_db_instance_a to manati_db_user;

    alter role manati_db_user createrole createdb;

    CTRL-D (to output the postgres db shell)

## Verify that the db was created successfully
10. As the postgres user

    psql -h localhost -d manati_db_instance_a -U manati_db_user

    (and put the password)

After putting the password you should be logged in in the postgres.

You can change the password of the manati_db_user in the database and the in the code in the file manati/settings.py

## Run migrate files
10a. python ./manage.py makemigrations background_task
10b. python ./manage.py makemigrations guardian
11. python ./manage.py migrate

## Create super user for login in the web system if you need
12. python manage.py createsuperuser

## How to run it
It is not recommended to run the server as root, but since only root can open ports numbers less than 1024, it is up to you which user you use. By default it opens the port 8000, so you can run it as root:

    python ./manage.py runserver

After this, just open your browser in [http://localhost:8000/manati_ui](http://localhost:8000/manati_ui)

If you want to open the server in the network, you can do it with:

    python ./manage.py runserver <ip-address>:8000

## Settings: Updating version for previous deploys
cd path/to/project_directory
1. git pull origin master
2. pip install -r requirements
3. python ./manage.py makemigrations background_task
4. python ./manage.py makemigrations guardian
5. python ./manage.py migrate
6. python ./manage.py runserver


# BACKUP DB
pg_dump -U manati_db_user -W -F p manati_db > backup.sql # plain text

# RESTORE DB
psql manati_db -f backup.sql
